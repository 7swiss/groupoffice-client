<form class="ab-contact-form form-horizontal" name="contactForm" im-submit="save()" novalidate> <div class="iae-toolbar"> <ul class="iae-left-toolbar"> <li> <a ng-click="cancel();" class="btn btn-default"><span class="fa fa-chevron-left"></span></a> </li> <li> <button type="submit" class="btn btn-primary"> <i class="fa fa-floppy-o"></i> {{'Save'| t}} </button> </li> </ul> </div> <div class="iae-scrollable-panel"> <div class="row"> <div class="col-lg-6"> <div class="panel panel-default"> <div class="panel-body"> <div> <div class="form-group"> <label ng-if="!contact.attributes.isCompany" class="col-sm-3 control-label" for="contactName">{{"Name"| t}}</label> <label ng-if="contact.attributes.isCompany" class="col-sm-3 control-label" for="companyName">{{"Name"| t}}</label> <div class="col-sm-9 ab-name-group"> <div class="input-group" ng-if="!contact.attributes.isCompany"> <input type="text" id="name" name="contactName" class="form-control" ng-model="contact.attributes.name" ng-change="changeFullName()" required autofocus> <div class="input-group-btn"> <button type="button" ng-click="toggleName()" class="btn btn-default"><i class="fa" ng-class="{'fa-chevron-down': !showNameParts, 'fa-chevron-up': showNameParts}"></i></button> </div> </div> <input ng-if="contact.attributes.isCompany" type="text" id="name" name="companyName" class="form-control" ng-model="contact.attributes.name" required autofocus> <im-image-upload-placeholder class="ab-contact-photo" im-image-attribute="contact.attributes.photoFilePath" im-image-temp-attribute="contact.attributes.photoTempPath" im-delete-permission="contact.permissions.editAccess" im-thumb-route="Intermesh/contacts/contact/thumb" im-original-route="Intermesh/contacts/contact/original" im-thumb-width="75" im-thumb-height="100"></im-image-upload-placeholder> <!--									<div class="ab-contact-photo"
										 flow-name="uploader.flow"
										 flow-init="{singleFile:true, target: uploadTarget}"
										 flow-file-added="!!{png:1,gif:1,jpg:1,jpeg:1}[$file.getExtension()]"
										 flow-files-submitted="$flow.upload()"
										 flow-file-success="uploadSuccess($file, $message);"
										 >
										<div class="thumbnail" flow-drop flow-btn>
											<img ng-if="photoUrl" ng-src="{{photoUrl}}" alt="Contact photo" />
											<i ng-if="!photoUrl" class="fa fa-user"></i>
										</div>

										<div ng-repeat="file in $flow.files">
											<div class="progress progress-striped" ng-class="{active: file.isUploading()}">
												<div class="progress-bar" role="progressbar"
													 aria-valuenow="{{file.progress() * 100}}"
													 aria-valuemin="0"
													 aria-valuemax="100"
													 ng-style="{width: (file.progress() * 100) + '%'}">
													<span class="sr-only">{{file.progress()}}% Complete</span>
												</div>
											</div>
										</div>--> <!--						   <div>
														   <span class="btn btn-primary" ><i class="fa fa-plus"></i></span>
														   <span class="btn btn-danger" ng-show="hasPhoto()" ng-click="removePhoto()">
															   <i class="fa fa-trash-o"></i>
														   </span>
													   </div>--> <!--</div>--> <im-show-error ng-if="!contact.attributes.isCompany" for="contactName" im-model="contact"></im-show-error> <im-show-error ng-if="contact.attributes.isCompany" for="companyName" im-model="contact"></im-show-error> </div> </div> </div> <div ng-if="showNameParts"> <div class="form-group"> <label class="col-sm-3 control-label" for="firstName">{{"First name"| t}}</label> <div class="col-sm-9"> <input type="text" id="firstName" class="form-control" ng-model="contact.attributes.firstName" required> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="middleName">{{"Middle name"| t}}</label> <div class="col-sm-9"> <input type="text" id="middleName" class="form-control" ng-model="contact.attributes.middleName"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label" for="lastName">{{"Last name"| t}}</label> <div class="col-sm-9"> <input type="text" id="lastName" class="form-control" ng-model="contact.attributes.lastName"> </div> </div> </div> <div class="form-group" ng-if="!contact.attributes.isCompany"> <label class="col-sm-3 control-label">{{"Gender"| t}}</label> <div class="col-sm-9"> <label class="radio-inline"> <input type="radio" ng-model="contact.attributes.gender" ng-value="null"> {{"Unknown"| t}} </label> <label class="radio-inline"> <input type="radio" ng-model="contact.attributes.gender" value="M"> {{"Male"| t}} </label> <label class="radio-inline"> <input type="radio" ng-model="contact.attributes.gender" value="F"> {{"Female"| t}} </label> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">{{"Special dates"| t}}</label> <div class="col-sm-9"> <div ng-if="!specialDate.attributes.markDeleted" class="im-input-group-multiple input-group" ng-repeat="specialDate in contact.attributes.dates"> <div class="input-group-btn"> <ui-select ng-model="specialDate.attributes.type"> <ui-select-match class="ab-multi-input-select" placeholder="Please select...">{{$select.selected.label}}</ui-select-match> <ui-select-choices repeat="item.value as item in dateOptions | filter: $select.search"> <div ng-bind-html="item.label | highlight: $select.search"></div> </ui-select-choices> </ui-select> </div> <input type="text" class="form-control" ng-model="specialDate.attributes.date" datepicker-popup="dd-MM-yyyy" is-open="specialDate.isOpen" close-text="{{'Close' | t}}"> <div class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="openDate(specialDate, $event)"><i class="fa fa-calendar"></i></button> <button type="button" class="btn btn-danger" ng-click="specialDate.attributes.markDeleted = true;"><i class="fa fa-trash-o"></i></button> </div> </div> <span class="btn btn-default" ng-click="addDate()"><i class="fa fa-plus"></i> {{"Add special date"| t}}</span> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">{{"E-mail"| t}}</label> <div class="col-sm-9"> <div ng-if="!emailAddress.attributes.markDeleted" ng-repeat="emailAddress in contact.attributes.emailAddresses"> <div class="im-input-group-multiple input-group"> <div class="input-group-btn"> <!--<select style="width:120px" class="form-control" ng-model="emailAddress.attributes.type" ng-options="number.value as number.label for number in emailAddressOptions"></select>--> <!--
																			<button type="button" class="btn btn-default ab-multi-input-select" ng-model="emailAddress.attributes.type" data-html="1" ng-options="type.value as type.label for type in emailAddressOptions" bs-select>
																				Type <span class="caret"></span>
																			</button>--> <ui-select ng-model="emailAddress.attributes.type"> <ui-select-match class="ab-multi-input-select" placeholder="Please select...">{{$select.selected.label}}</ui-select-match> <ui-select-choices repeat="item.value as item in emailAddressOptions | filter: $select.search"> <div ng-bind-html="item.label | highlight: $select.search"></div> </ui-select-choices> </ui-select> </div> <input type="email" name="email" ng-model="emailAddress.attributes.email" class="form-control" autofocus> <span class="input-group-btn"> <button type="button" class="btn btn-danger" ng-click="emailAddress.attributes.markDeleted = true;"><i class="fa fa-trash-o"></i></button> </span> </div> <im-show-error for="email" im-model="emailAddress"></im-show-error> </div> <span class="btn btn-default" ng-click="addEmailAddress()"><i class="fa fa-plus"></i> {{"Add e-mail address"| t}}</span> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">{{"Phone"| t}}</label> <div class="col-sm-9"> <div ng-if="!phoneNumber.attributes.markDeleted" class="im-input-group-multiple input-group" ng-repeat="phoneNumber in contact.attributes.phoneNumbers"> <div class="input-group-btn"> <!--<select style="width:120px" class="form-control" ng-model="phoneNumber.attributes.type" ng-options="number.value as number.label for number in phoneNumberOptions"></select>--> <!--									<button type="button" class="btn btn-default ab-multi-input-select" ng-model="phoneNumber.attributes.type" data-html="1" ng-options="type.value as type.label for type in phoneNumberOptions" bs-select>
																				Type <span class="caret"></span>
																			</button>--> <ui-select ng-model="phoneNumber.attributes.type"> <ui-select-match class="ab-multi-input-select" placeholder="Please select..."><span ng-bind-html="$select.selected.label"></span></ui-select-match> <ui-select-choices repeat="item.value as item in phoneNumberOptions | filter: $select.search"> <div ng-bind-html="item.label | highlight: $select.search"></div> </ui-select-choices> </ui-select> </div> <input type="text" ng-model="phoneNumber.attributes.number" class="form-control" autofocus> <span class="input-group-btn"> <button type="button" class="btn btn-danger" ng-click="phoneNumber.attributes.markDeleted = true;"><i class="fa fa-trash-o"></i></button> </span> </div> <span class="btn btn-default" ng-click="addPhoneNumber()"><i class="fa fa-plus"></i> {{"Add phone number"| t}}</span> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">{{"Tags"| t}}</label> <div class="col-sm-9"> <im-multi-select-field auto-create="true" store-route="Intermesh/tags/tag/store" model-attribute="contact.attributes.tags" model-attribute-display-name="name" input-placeholder="{{'Add tags...'| t}}"> </im-multi-select-field> </div> </div> <script type="text/ng-template" id="customTemplate.html"><a>
							  <span ng-if="!match.model.attributes.id">{{"Create new company" | t}}: </span>
								<span bind-html-unsafe="match.label | typeaheadHighlight:query"></span>
							</a></script> <div class="form-group" ng-if="!contact.attributes.isCompany"> <label class="col-sm-3 control-label">{{"Company"| t}}</label> <div class="col-sm-9"> <input type="text" typeahead-template-url="customTemplate.html" ng-model="contact.attributes.company" typeahead="company as company.attributes.name for company in getCompanies($viewValue)" class="form-control"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label">{{"Addresses"| t}}</label> <div class="col-sm-9"> <!--<div class="row">--> <div ng-if="!address.attributes.markDeleted" class="col-md-6" ng-repeat="address in contact.attributes.addresses"> <div class="form-group"> <div class="input-group"> <!--<select class="form-control" ng-model="address.attributes.type" ng-options="type.value as type.label for type in emailAddressOptions"></select>--> <!--										<button type="button" class="btn btn-default btn-bs-select" ng-model="address.attributes.type" data-html="1" ng-options="type.value as type.label for type in emailAddressOptions" bs-select>
																						Type <span class="caret"></span>
																					</button>--> <ui-select ng-model="address.attributes.type"> <ui-select-match class="ab-multi-input-select" placeholder="Please select...">{{$select.selected.label}}</ui-select-match> <ui-select-choices repeat="item.value as item in emailAddressOptions | filter: $select.search"> <div ng-bind-html="item.label | highlight: $select.search"></div> </ui-select-choices> </ui-select> <span class="input-group-btn"> <button type="button" class="btn btn-danger" ng-click="address.attributes.markDeleted = true;"><i class="fa fa-trash-o"></i></button> </span> </div> </div> <div class="form-group"> <textarea ng-model="address.attributes.street" class="form-control" autofocus style="height:70px" placeholder="{{'Street address'| t}}"></textarea> </div> <div class="form-group"> <input type="text" ng-model="address.attributes.zipCode" placeholder="{{'Zip code'| t}}" class="form-control"> </div> <div class="form-group"> <input type="text" ng-model="address.attributes.city" placeholder="{{'City'| t}}" class="form-control"> </div> <div class="form-group"> <input type="text" ng-model="address.attributes.state" placeholder="{{'State / Province / Region'| t}}" class="form-control"> </div> <div class="form-group"> <input type="text" ng-model="address.attributes.country" placeholder="{{'Country'| t}}" class="form-control"> </div> </div> </div> <!--</div>--> <div class="col-sm-offset-3 col-sm-9"> <span class="btn btn-default" ng-click="addAddress()"><i class="fa fa-plus"></i> {{"Add address"| t}}</span> </div> </div> </div> </div> </div> <div class="col-lg-6"> <im-custom-fields-edit im-model="contact" im-server-model="Intermesh\Modules\Contacts\Model\ContactCustomFields"></im-custom-fields-edit> </div> </div> </div> </form>